<!DOCTYPE html>
<html lang="en">
<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>RWA Tokenization Playground - Mock-Up Demo</title>
		<style>
				* {
						margin: 0;
						padding: 0;
						box-sizing: border-box;
				}

				body {
						font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
						background: linear-gradient(135deg, #22597e 0%, #361458 100%);
						min-height: 100vh;
						margin: 0;
						color: #333;
						padding-top: 80px;
				}

				.header {
						background: rgba(48, 0, 70, 0.5);
						backdrop-filter: blur(10px);
						padding: 1rem 0;
						box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
						position: fixed;
						top: 0;
						left: 0;
						right: 0;
						z-index: 1000;
				}

				.nav-container {
						max-width: 1200px;
						margin: 0 auto;
						display: flex;
						justify-content: space-between;
						align-items: center;
						padding: 0 2rem;
				}

				.logo {
						font-size: 1.5rem;
						font-weight: bold;
						color: white;
						text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
				}

				.user-info {
						display: flex;
						align-items: center;
						color: white;
						gap: 1rem;
				}

				.user-role {
						background: rgba(255, 255, 255, 0.2);
						padding: 0.5rem 1rem;
						border-radius: 20px;
						font-weight: 500;
				}

				.role-icons {
						display: flex;
						gap: 0.5rem;
				}

				.role-icon {
						width: 40px;
						height: 40px;
						border-radius: 50%;
						background: rgba(255, 255, 255, 0.4);
						border: 2px solid transparent;
						display: flex;
						align-items: center;
						justify-content: center;
						cursor: pointer;
						font-size: 1.2rem;
						transition: all 0.3s ease;
				}

				.role-icon:hover {
						background: rgba(255, 255, 255, 0.3);
						transform: scale(1.1);
				}

				.role-icon.active {
						background: rgba(255, 255, 255, 0.4);
						border-color: rgba(255, 255, 255, 0.8);
						box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
				}

				.container {
						max-width: 1400px;
						margin: 0 auto;
						padding: 2rem;
				}

				.demo-controls {
						text-align: center;
						margin-bottom: 2rem;
				}

				.demo-controls button {
						background: rgba(255, 255, 255, 0.2);
						border: 2px solid rgba(255, 255, 255, 0.3);
						color: white;
						padding: 0.75rem 2rem;
						margin: 0.5rem;
						border-radius: 25px;
						cursor: pointer;
						font-weight: 600;
						transition: all 0.3s ease;
				}

				.demo-controls button:hover {
						background: rgba(255, 255, 255, 0.3);
						transform: translateY(-2px);
				}

				.demo-controls button.active {
						background: #4CAF50;
						border-color: #4CAF50;
				}

				.module-grid {
						display: grid;
						grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
						gap: 2rem;
				}

				.module-group {
						margin-bottom: 3rem;
						padding: 1.5rem;
						border-radius: 20px;
						backdrop-filter: blur(20px);
				}

				.module-group.tokenization {
						background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
						border: 4px solid rgba(102, 126, 234, 0.5);
				}

				.module-group.lifecycle {
						background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(139, 195, 74, 0.1));
						border: 4px solid rgba(139, 76, 175, 0.5);
				}

				.module-group-title {
						font-size: 1.5rem;
						font-weight: 700;
						color: white;
						text-align: center;
						margin-bottom: 2rem;
						text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
				}

				.module-group-grid {
						display: grid;
						grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
						gap: 2rem;
				}

				.module-card {
						background: rgba(255, 255, 255, 0.9);
						border-radius: 15px;
						padding: 2rem;
						box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
						backdrop-filter: blur(10px);
						border: 1px solid rgba(255, 255, 255, 0.18);
						transition: all 0.3s ease;
				}

				.module-card:hover {
						transform: translateY(-5px);
						box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
				}

				.module-header {
						display: flex;
						align-items: center;
						margin-bottom: 1.5rem;
				}

				.module-icon {
						width: 40px;
						height: 40px;
						border-radius: 10px;
						margin-right: 1rem;
						display: flex;
						align-items: center;
						justify-content: center;
						font-size: 1.5rem;
				}

				.module-icon.preparation { background: linear-gradient(135deg, #FF6B6B, #FF8E53); }
				.module-icon.onboarding { background: linear-gradient(135deg, #4ECDC4, #44A08D); }
				.module-icon.issuance { background: linear-gradient(135deg, #45B7D1, #96CEB4); }
				.module-icon.servicing { background: linear-gradient(135deg, #96CEB4, #FFECD2); }
				.module-icon.distribution { background: linear-gradient(135deg, #A8EDEA, #FED6E3); }

				.module-title {
						font-size: 1.3rem;
						font-weight: 600;
						color: #333;
				}

				.form-group {
						margin-bottom: 1.5rem;
				}

				.form-group label {
						display: block;
						margin-bottom: 0.5rem;
						font-weight: 500;
						color: #555;
				}

				.form-group input,
				.form-group select,
				.form-group textarea {
						width: 100%;
						padding: 0.75rem;
						border: 2px solid #e0e0e0;
						border-radius: 8px;
						font-size: 1rem;
						transition: border-color 0.3s ease;
				}

				.form-group input:focus,
				.form-group select:focus,
				.form-group textarea:focus {
						outline: none;
						border-color: #667eea;
				}

				.btn {
						background: linear-gradient(135deg, #667eea, #764ba2);
						color: white;
						border: none;
						padding: 0.75rem 1.5rem;
						border-radius: 8px;
						cursor: pointer;
						font-weight: 600;
						margin: 0.25rem;
						transition: all 0.3s ease;
				}

				.btn:hover {
						transform: translateY(-2px);
						box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
				}

				.btn.secondary {
						background: linear-gradient(135deg, #764ba2, #667eea);
				}

				.btn.danger {
						background: linear-gradient(135deg, #f44336, #d32f2f);
				}

				.btn.guide {
						background: rgba(255, 255, 255, 0.08);
						color: #888;
						border: 1px solid rgba(0, 0, 0, 0.08);
						font-size: 0.8rem;
						padding: 0.4rem 0.8rem;
						margin-left: auto;
						display: block;
						margin-top: 0.75rem;
						text-align: right;
						width: fit-content;
						align-self: flex-end;
						font-weight: 400;
						opacity: 0.8;
				}

				.btn.guide:hover {
						background: rgba(255, 255, 255, 0.15);
						color: #555;
						transform: translateY(-1px);
						box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
						opacity: 1;
				}

				/* Sharp gradient buttons with 90-degree effect */
				.btn.gradient-sharp {
						background: linear-gradient(90deg, #ff6b6b 0%, #4ecdc4 50%, #45b7d1 100%);
						background-size: 200% 100%;
						animation: gradientShift 3s ease infinite;
						color: white;
						font-weight: 600;
						text-shadow: 0 1px 2px rgba(0,0,0,0.3);
						box-shadow: 0 4px 15px rgba(0,0,0,0.2);
				}

				.btn.gradient-sharp:hover {
						background: linear-gradient(90deg, #ff5252 0%, #26a69a 50%, #2196f3 100%);
						background-size: 200% 100%;
						transform: translateY(-3px);
						box-shadow: 0 8px 25px rgba(0,0,0,0.3);
				}

				@keyframes gradientShift {
						0% { background-position: 0% 50%; }
						50% { background-position: 100% 50%; }
						100% { background-position: 0% 50%; }
				}

				/* Role switching button */
				.btn.role-switch {
						background: linear-gradient(90deg, #8e44ad 0%, #3498db 50%, #27ae60 100%);
						background-size: 200% 100%;
						animation: roleGradientShift 4s ease infinite;
						color: white;
						font-weight: 700;
						text-shadow: 0 1px 3px rgba(0,0,0,0.4);
						box-shadow: 0 3px 12px rgba(0,0,0,0.25);
						border: 2px solid rgba(255,255,255,0.2);
						margin-bottom: 1rem;
						font-size: 0.9rem;
				}

				.btn.role-switch:hover {
						background: linear-gradient(90deg, #9b59b6 0%, #3498db 50%, #2ecc71 100%);
						background-size: 200% 100%;
						transform: translateY(-2px) scale(1.02);
						box-shadow: 0 6px 20px rgba(0,0,0,0.35);
						border-color: rgba(255,255,255,0.4);
				}

				@keyframes roleGradientShift {
						0% { background-position: 0% 50%; }
						33% { background-position: 100% 50%; }
						66% { background-position: 0% 50%; }
						100% { background-position: 100% 50%; }
				}

				.progress-bar {
						background: #e0e0e0;
						height: 6px;
						border-radius: 3px;
						margin: 1rem 0;
						overflow: hidden;
				}

				.progress-fill {
						background: linear-gradient(90deg, #667eea, #764ba2);
						height: 100%;
						transition: width 0.3s ease;
				}

				.status-indicator {
						display: inline-block;
						width: 12px;
						height: 12px;
						border-radius: 50%;
						margin-right: 0.5rem;
				}

				.status-indicator.active { background: #4CAF50; }
				.status-indicator.pending { background: #FF9800; }
				.status-indicator.inactive { background: #ccc; }

				.data-table {
						width: 100%;
						border-collapse: collapse;
						margin: 1rem 0;
				}

				.data-table th,
				.data-table td {
						padding: 0.75rem;
						text-align: left;
						border-bottom: 1px solid #e0e0e0;
				}

				.data-table th {
						background: #f5f5f5;
						font-weight: 600;
				}

				.notification {
						background: #e3f2fd;
						border-left: 4px solid #2196F3;
						padding: 1rem;
						margin: 1rem 0;
						border-radius: 4px;
				}

				.notification.success {
						background: #e8f5e8;
						border-color: #4CAF50;
				}

				.notification.warning {
						background: #fff8e1;
						border-color: #FF9800;
				}

				.hidden {
						display: none !important;
						visibility: hidden !important;
						pointer-events: none !important;
				}

				.dashboard-stats {
						display: grid;
						grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
						gap: 1rem;
						margin-bottom: 2rem;
				}

				.stat-card {
						background: rgba(255, 255, 255, 0.1);
						backdrop-filter: blur(10px);
						padding: 1.5rem;
						border-radius: 10px;
						text-align: center;
						color: white;
				}

				.stat-value {
						font-size: 2rem;
						font-weight: bold;
						margin-bottom: 0.5rem;
				}

				.stat-label {
						font-size: 0.9rem;
						opacity: 0.8;
				}

				.modal {
						position: fixed;
						top: 0;
						left: 0;
						width: 100%;
						height: 100%;
						background: rgba(0, 0, 0, 0.5);
						display: flex;
						align-items: center;
						justify-content: center;
						z-index: 1000;
				}

				.modal-content {
						background: linear-gradient(135deg, #1c1c1e 0%, #051044 100%);
						padding: 2rem;
						border-radius: 15px;
						max-width: 600px;
						width: 90%;
						max-height: 80vh;
						overflow-y: auto;
						color: #6666aa;
						border: 2px solid #3a3a3c;
						box-shadow: 
								0 20px 40px rgba(0, 0, 0, 0.8),
								0 8px 25px rgba(0, 0, 0, 0.6);
				}

				.modal-content h1, 
				.modal-content h2, 
				.modal-content h3, 
				.modal-content h4, 
				.modal-content h5, 
				.modal-content h6 {
						background: transparent;
						color: #8181f1;
						margin: 1rem 0 0.5rem 0;
				}

				.modal-content pre {
						color: #f2f2f7;
						font-size: 0.8rem;
						line-height: 1.3;
						white-space: pre-wrap;
						font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
				}

				.close-modal {
						float: right;
						font-size: 1.5rem;
						cursor: pointer;
						color: #8e8e93;
						transition: color 0.3s ease;
				}

				.close-modal:hover {
						color: #f2f2f7;
				}

				.footer {
						text-align: center;
						margin-top: 40px;
						padding: 20px;
				}

				.footer a {
						color: rgba(255, 255, 255, 0.8);
						text-decoration: none;
						font-size: 0.9rem;
						font-weight: 500;
						transition: all 0.3s ease;
						padding: 10px 20px;
						border-radius: 25px;
						background: rgba(255, 255, 255, 0.1);
						backdrop-filter: blur(10px);
						border: 1px solid rgba(255, 255, 255, 0.2);
				}

				.footer a:hover {
						color: #ffffff;
						background: rgba(255, 255, 255, 0.2);
						transform: translateY(-2px);
						box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
				} 

				@media (max-width: 768px) {
						.module-grid {
								grid-template-columns: 1fr;
						}
						
						.nav-container {
								flex-direction: column;
								gap: 1rem;
						}
						
						/* Remove borders from module groups to save space */
						.module-group.tokenization,
						.module-group.lifecycle {
								border: none;
								padding: 1rem;
						}
						
						.module-group-grid {
								grid-template-columns: 1fr;
						}
						
						/* Reduce font sizes for mobile */
						.logo {
								font-size: 1.1rem;
						}
						
						.role-switch {
								font-size: 1rem;
						}
						
						.module-card h3 {
								font-size: 1.3rem;
						}
						
						.module-card h4 {
								font-size: 1.1rem;
						}
						
						.guide-button {
								font-size: 0.9rem;
						}
						
						.button {
								font-size: 0.85rem;
								padding: 10px 18px;
						}
						
						.footer a {
								font-size: 0.8rem;
								padding: 8px 16px;
						}
						
						.modal-content {
								padding: 1.5rem;
								font-size: 0.85rem;
						}
						
						.modal-content pre {
								font-size: 0.75rem;
								line-height: 1.2;
						}
						
						.home-button {
								width: 50px;
								height: 50px;
								font-size: 20px;
						}
				}
				
				@media (max-width: 480px) {
						/* Remove borders from module groups to save space */
						.module-group.tokenization,
						.module-group.lifecycle {
								border: none;
								padding: 0.8rem;
								margin-bottom: 2rem;
						}
						
						.module-group-grid {
								grid-template-columns: 1fr;
								gap: 1.5rem;
						}
						
						/* Further reduce font sizes for small mobile */
						.logo {
								font-size: 1rem;
						}
						
						.role-switch {
								font-size: 0.9rem;
								padding: 6px 12px;
						}
						
						.module-card h3 {
								font-size: 1.1rem;
						}
						
						.module-card h4 {
								font-size: 1rem;
						}
						
						.guide-button {
								font-size: 0.8rem;
								padding: 6px 12px;
						}
						
						.button {
								font-size: 0.8rem;
								padding: 8px 15px;
						}
						
						.footer a {
								font-size: 0.75rem;
								padding: 6px 12px;
						}
						
						.modal-content {
								padding: 1rem;
								font-size: 0.8rem;
						}
						
						.modal-content pre {
								font-size: 0.7rem;
								line-height: 1.1;
						}
						
						.close-modal {
								font-size: 1.3rem;
						}
						
						.home-button {
								width: 45px;
								height: 45px;
								font-size: 18px;
						}
				}

        /* Home Button Styles */
        .home-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: rgba(0, 200, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            font-size: 24px;
            box-shadow: 
                0 4px 20px rgba(0, 200, 255, 0.3),
                0 2px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(15px);
        }

        .home-button:hover {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 
                0 8px 30px rgba(0, 200, 255, 0.5),
                0 4px 20px rgba(0, 0, 0, 0.3);
            background: rgba(0, 212, 255, 0.5);
            color: white;
            text-decoration: none;
            border-color: rgba(255, 255, 255, 0.5);
        }

        .home-button:active {
            transform: translateY(-1px) scale(1.05);
        }

        @keyframes homeButtonPulse {
            0%, 100% {
                box-shadow: 
                    0 4px 20px rgba(0, 200, 255, 0.3),
                    0 2px 10px rgba(0, 0, 0, 0.2);
            }
            50% {
                box-shadow: 
                    0 6px 25px rgba(0, 200, 255, 0.5),
                    0 3px 15px rgba(0, 0, 0, 0.3);
            }
        }

        .home-button {
            animation: homeButtonPulse 3s ease-in-out infinite;
        }				
		</style>
</head>
<body>
		<header class="header">
				<div class="nav-container">
						<div class="logo">RWA Tokenization Playground</div>
						<div class="user-info">
								<div class="user-role" id="currentRole">Issuer ‚è©</div>
								<div class="role-icons">
										<div class="role-icon active" id="issuerIcon" onclick="switchToRole('issuer')" title="Issuer">üèõ</div>
										<div class="role-icon" id="investorIcon" onclick="switchToRole('investor')" title="Investor">üë§</div>
										<div class="role-icon" id="adminIcon" onclick="switchToRole('admin')" title="Admin">‚öôÔ∏è</div>
								</div>
						</div>
				</div>
		</header>

		<div class="container">
				<!-- Demo Controls -->
				<div class="demo-controls">
						<button class="btn gradient-sharp" onclick="loadSampleData()">üìä Load Sample Data</button>
						<button onclick="startTour()">üéØ Guided Tour</button>
						<button onclick="startInteractiveTour()">üìñ Walkthrough</button>
						<button onclick="resetDemo()" id="resetBtn">üîÑ Reset Demo</button>
						<button onclick="showRoleInfo()" id="roleInfoBtn">‚ÑπÔ∏è Role Info</button>
				</div>

				<!-- Dashboard Stats -->
				<div class="dashboard-stats" id="dashboardStats">
						<div class="stat-card">
								<div class="stat-value" id="totalRWAs">0</div>
								<div class="stat-label">RWAs Prepared</div>
						</div>
						<div class="stat-card">
								<div class="stat-value" id="totalInvestors">0</div>
								<div class="stat-label">Investors Onboarded</div>
						</div>
						<div class="stat-card">
								<div class="stat-value" id="totalTokens">$0</div>
								<div class="stat-label">Tokens Issued</div>
						</div>
						<div class="stat-card">
								<div class="stat-value" id="totalTrades">0</div>
								<div class="stat-label">Secondary Trades</div>
						</div>
				</div>

				<!-- Module Groups -->
				<!-- TOKENIZATION GROUP -->
				<div class="module-group tokenization">
						<div class="module-group-title">ü™ô TOKENIZATION PHASE</div>
						<div class="module-group-grid">
								<!-- RWA Preparation Module -->
								<div class="module-card" id="preparationModule">
								<div class="module-header">
										<div class="module-icon preparation">üè¢</div>
										<div>
												<div class="module-title">RWA Preparation & Valuation</div>
												<div class="progress-bar">
														<div class="progress-fill" id="preparationProgress" style="width: 0%"></div>
												</div>
										</div>
								</div>

								<div class="form-group">
										<label>Asset Type</label>
										<select id="assetType">
												<option value="">Select Asset Type</option>
												<option value="real-estate">Real Estate</option>
												<option value="private-equity">Private Equity</option>
												<option value="commodities">Commodities</option>
												<option value="art">Art & Collectibles</option>
										</select>
								</div>

								<div class="form-group">
										<label>Asset Description</label>
										<textarea id="assetDescription" placeholder="Enter detailed asset description..."></textarea>
								</div>

								<div class="form-group">
										<label>Token Symbol</label>
										<input type="text" id="assetTokenSymbol" placeholder="e.g., RET01, ART01, COM01" maxlength="8" style="text-transform: uppercase;">
										<small>Unique identifier for this asset token (max 8 characters)</small>
								</div>

								<div class="form-group">
										<label>Jurisdiction</label>
										<select id="jurisdiction">
												<option value="">Select Jurisdiction</option>
												<option value="us">Hong Kong</option>
												<option value="eu">United Kingdom</option>
												<option value="sg">Singapore</option>
												<option value="ae">United Arab Emirates</option>
										</select>
								</div>

								<div class="form-group">
										<label>Valuation Amount ($)</label>
										<input type="number" id="valuationAmount" placeholder="Enter valuation amount">
								</div>

								<div class="form-group">
										<label>Valuation Date</label>
										<input type="date" id="valuationDate">
								</div>

								<button class="btn gradient-sharp" onclick="prepareRWA()">Prepare RWA</button>
								<button class="btn secondary" onclick="viewRWAsList()">View RWAs List</button>
								<button class="btn guide" onclick="showRWAPreparationGuide()">üîç RWA Preparation Guide</button>
						</div>

						<!-- Investor Onboarding Module -->
						<div class="module-card" id="onboardingModule">
								<div class="module-header">
										<div class="module-icon onboarding">üë•</div>
										<div>
												<div class="module-title">Investor Onboarding</div>
												<div class="progress-bar">
														<div class="progress-fill" id="onboardingProgress" style="width: 0%"></div>
												</div>
										</div>
								</div>

								<div id="investorView" class="hidden">
										<button class="btn role-switch" onclick="switchToIssuerRole()">üîÑ Switch to Issuer View</button>
										
										<div class="form-group">
												<label>Full Name</label>
												<input type="text" id="investorName" placeholder="Enter full name">
										</div>

										<div class="form-group">
												<label>Blockchain Wallet Address</label>
												<!-- input type="text" id="investorWallet" placeholder="0x... (Enter your wallet address for receiving tokens)" pattern="^0x[a-fA-F0-9]{40}$" -->
												<input type="text" id="investorWallet" placeholder="0x... (Enter your wallet address for receiving tokens)" pattern="^0x[a-fA-F0-9]">
												<small>This wallet will receive your allocated tokens</small>
										</div>

										<div class="form-group">
												<label>Investment Amount ($)</label>
												<input type="number" id="investmentAmount" placeholder="Enter investment amount">
										</div>

										<button class="btn" onclick="submitKYC()">Submit KYC</button>
										<button class="btn guide" onclick="showInvestorOnboardingGuide()">üîç Investor Onboarding Guide</button>
								</div>

								<div id="issuerView">
										<button class="btn role-switch" onclick="switchToInvestorRole()">üîÑ Switch to Investor View</button>
										
										<div class="notification" id="kycQueue">
												<span class="status-indicator pending"></span>
												<strong>KYC Queue:</strong> 0 pending applications
										</div>

								<button class="btn" onclick="reviewKYC()">Review KYC Applications</button>
								<button class="btn secondary" onclick="viewInvestorsList()">View Investors</button>
								<button class="btn guide" onclick="showInvestorOnboardingGuide()">üîç Investor Onboarding Guide</button>
								</div>								<div id="adminView" class="hidden">
										<button class="btn role-switch" onclick="switchToInvestorRole()">üîÑ Switch to Investor View</button>
										
										<div class="notification">
												<span class="status-indicator active"></span>
												<strong>Admin Dashboard:</strong> Platform oversight and compliance
										</div>

										<div class="form-group">
												<label>Platform Actions</label>
												<select id="adminAction">
														<option value="">Select Admin Action</option>
														<option value="audit-all">Audit All Transactions</option>
														<option value="compliance-check">Compliance Check</option>
														<option value="freeze-platform">Freeze Platform</option>
														<option value="reset-platform">Reset Platform</option>
												</select>
										</div>

										<button class="btn" onclick="executeAdminAction()">Execute Admin Action</button>
										<button class="btn secondary" onclick="viewSystemLogs()">View System Logs</button>
										<button class="btn secondary" onclick="viewAllAssets()">View All Assets</button>
										<button class="btn danger" onclick="emergencyStop()">Emergency Stop</button>
										<button class="btn guide" onclick="showInvestorOnboardingGuide()">üîç Investor Onboarding Guide</button>
								</div>
						</div>

						<!-- Token Issuance Module -->
						<div class="module-card" id="issuanceModule">
								<div class="module-header">
										<div class="module-icon issuance">ü™ô</div>
										<div>
												<div class="module-title">RWA Token Issuance</div>
												<div class="progress-bar">
														<div class="progress-fill" id="issuanceProgress" style="width: 0%"></div>
												</div>
										</div>
								</div>

								<!-- div class="notification">
										<strong>üìã Note:</strong> This is <u>NOT an ICO</u> - Tokens represent fractional ownership of real assets, distributed only to KYC-approved accredited investors.
								</div -->

								<div class="form-group">
										<label>Select Asset to Tokenize</label>
										<select id="assetSelector">
												<option value="">Select prepared RWA asset</option>
										</select>
										<small>Choose from your prepared assets</small>
								</div>

								<div class="form-group">
										<label>Token Name</label>
										<input type="text" id="tokenName" placeholder="e.g., Central Plaza Real Estate Token">
								</div>

								<div class="form-group">
										<label>Asset Value ($)</label>
										<input type="number" id="assetValue" readonly placeholder="Select asset to see value" style="background-color: #f5f5f5;">
										<small>Total value of the underlying asset</small>
								</div>

								<div class="form-group">
										<label>Token Price ($) - Minimum Investment Unit</label>
										<input type="number" id="tokenPrice" step="0.01" placeholder="e.g., 1000 (minimum $1000 per token)" oninput="calculateTokenSupply()">
										<small>Price per individual token</small>
								</div>

								<div class="form-group">
										<label>Total Token Supply (Auto-Calculated)</label>
										<input type="number" id="tokenSupply" readonly placeholder="Auto-calculated based on formula" style="background-color: #f5f5f5;">
										<small><strong>Formula:</strong> Tokens = Asset Value √∑ Token Price</small>
										<div id="calculationDisplay" style="margin-top: 8px; padding: 10px; background-color: #e3f2fd; border-radius: 4px; font-size: 0.9em; display: none;">
												<strong>üìä Calculation:</strong> <span id="calculationFormula"></span>
										</div>
								</div>

								<div class="notification" id="contractStatus">
										<strong>Contract Status:</strong> Not deployed
								</div>

								<button class="btn gradient-sharp" onclick="deployContract()">Deploy ERC3643 Contract</button>
								<button class="btn secondary" onclick="allocateTokens()">Allocate to Investors</button>
								<button class="btn" onclick="viewCapTable()">View Ownership Table</button>
								<button class="btn guide" onclick="showTokenVsICO()">üîç Token vs ICO Guide</button>
						</div>
						</div>
				</div>

				<!-- LIFECYCLE GROUP -->
				<div class="module-group lifecycle">
						<div class="module-group-title">üîÑ LIFECYCLE MANAGEMENT</div>
						<div class="module-group-grid">

						<!-- Servicing Module -->
						<div class="module-card" id="servicingModule">
								<div class="module-header">
										<div class="module-icon servicing">‚öôÔ∏è</div>
										<div>
												<div class="module-title">Asset & Token Lifecycle Management</div>
												<div class="progress-bar">
														<div class="progress-fill" id="servicingProgress" style="width: 0%"></div>
												</div>
										</div>
								</div>

								<div class="notification">
										<strong>üíº Purpose:</strong> Manage ongoing asset events, distributions, and compliance throughout the investment lifecycle.
								</div>

								<div class="form-group">
										<label>Select Asset Token</label>
										<select id="servicingAssetSelector">
												<option value="">Select deployed token to service</option>
										</select>
										<small>Choose from your deployed asset tokens</small>
								</div>

								<div class="form-group">
										<label>Corporate Action Type</label>
										<select id="corporateAction">
												<option value="">Select Action</option>
												<option value="dividend">Distribute Rental Income</option>
												<option value="mint">Asset Appreciation (Mint Tokens)</option>
												<option value="burn">Asset Liquidation (Burn Tokens)</option>
												<option value="pause">Compliance Review (Pause Transfers)</option>
												<option value="force-transfer">Regulatory Order (Force Transfer)</option>
												<option value="split">Token Split (Stock Split Equivalent)</option>
										</select>
								</div>

								<div class="form-group">
										<label>Action Details</label>
										<input type="text" id="actionParameter" placeholder="Enter amount, address, or description">
										<small id="actionHelp">Select an action above for specific guidance</small>
								</div>

								<div class="form-group">
										<label>Notification to Investors</label>
										<textarea id="investorMessage" placeholder="Message to be sent to all token holders..."></textarea>
								</div>

								<button class="btn gradient-sharp" onclick="executeCorporateAction()">Execute Action</button>
								<button class="btn secondary" onclick="generateReport()">Asset Performance Report</button>
								<button class="btn" onclick="openMessaging()">Investor Communications</button>
								<button class="btn guide" onclick="showServicingExamples()">ÔøΩ Servicing Examples</button>
						</div>

						<!-- Distribution & Marketing Module -->
						<div class="module-card" id="distributionModule">
								<div class="module-header">
										<div class="module-icon distribution">üìà</div>
										<div>
												<div class="module-title">Secondary Distribution</div>
												<div class="progress-bar">
														<div class="progress-fill" id="distributionProgress" style="width: 0%"></div>
												</div>
										</div>
								</div>

								<div class="form-group">
										<label>Select Asset Token</label>
										<select id="distributionAssetSelector">
												<option value="">Select token for secondary trading</option>
										</select>
										<small>Choose from available asset tokens</small>
								</div>

								<div class="form-group">
										<label>Trading Status</label>
										<select id="tradingStatus" onchange="toggleTrading()">
												<option value="disabled">Trading Disabled</option>
												<option value="enabled">Trading Enabled</option>
										</select>
								</div>

								<div id="tradingOptions" class="hidden">
										<div class="form-group">
												<label>Trade Type</label>
												<select id="tradeType">
														<option value="p2p">Peer-to-Peer</option>
														<option value="exchange">Centralized Exchange</option>
														<option value="defi">DeFi Protocol</option>
														<option value="otc">OTC Marketplace</option>
												</select>
										</div>

										<div class="form-group">
												<label>Trade Amount</label>
												<input type="number" id="tradeAmount" placeholder="Number of tokens">
										</div>

										<div class="form-group">
												<label>Price per Token ($)</label>
												<input type="number" id="tradePrice" step="0.01" placeholder="Price per token">
										</div>

										<button class="btn gradient-sharp" onclick="postTrade()">Post Trade Offer</button>
										<button class="btn secondary" onclick="viewTradeHistory()">Trade History</button>
										<button class="btn guide" onclick="showSecondaryTradingGuide()">üîç Secondary Trading Guide</button>
								</div>
						</div>
						</div>
				</div>
		</div>

    <div class="footer">
        <a href="http://www.realmatter.io" target="_blank">Contact us: Real Matter Technology Limited</a>
    </div>		

    <!-- Home Button -->
    <a href="https://realmatterio.github.io/web3" target="_blank" class="home-button" title="Go to Home Page">
        üè†
    </a>

		<!-- Modals -->
		<div id="modal" class="modal hidden">
				<div class="modal-content">
						<span class="close-modal" onclick="closeModal()">&times;</span>
						<div id="modalBody"></div>
				</div>
		</div>

		<script>
				// Global state
				let currentRole = 'issuer';
				let rwas = [];
				let investors = [];
				let tokens = [];
				let trades = [];
				let notifications = [];

				// Sample data
				const sampleRWAs = [
						{
								id: 1,
								type: 'real-estate',
								description: 'Luxury apartment complex in Central',
								tokenSymbol: 'RWA01',
								jurisdiction: 'Hong Kong',
								valuation: 50000000,
								date: '2025-01-15',
								status: 'prepared'
						},
						{
								id: 2,
								type: 'art',
								description: 'Contemporary art collection by emerging artists',
								tokenSymbol: 'RWA02',
								jurisdiction: 'China',
								valuation: 2500000,
								date: '2025-02-10',
								status: 'prepared'
						}
				];

				const sampleInvestors = [
						{
								id: 1,
								name: 'John Lee',
								wallet: '0x742d35Cc6bF8B4C40c84C6b80E4567c89B5E5F21',
								investment: 100000,
								status: 'approved',
								kycDate: '2024-01-20'
						},
						{
								id: 2,
								name: 'Sarah Lam',
								wallet: '0x8ba1f109551bD432803012645Hac136c82C5E591',
								investment: 250000,
								status: 'pending',
								kycDate: '2024-02-15'
						}
				];

				// Initialize app
				document.addEventListener('DOMContentLoaded', function() {
						setDefaultDate();
						updateAssetSelectors();
						updateDashboard();
						updateRoleView();
						updateModuleVisibility();

						// Add debugging logs to check modal visibility at startup
						const modal = document.getElementById('modal');
						console.log('Modal initial visibility:', modal.classList.contains('hidden') ? 'Hidden' : 'Visible');

						// Monitor changes to the modal's classList
						const observer = new MutationObserver((mutations) => {
								mutations.forEach((mutation) => {
										if (mutation.attributeName === 'class') {
												console.log('Modal visibility changed:', modal.classList.contains('hidden') ? 'Hidden' : 'Visible');
										}
								});
						});

						observer.observe(modal, { attributes: true });
				});

				// Role management
				function switchToRole(role) {
						currentRole = role;
						document.getElementById('currentRole').textContent = role.charAt(0).toUpperCase() + role.slice(1);
						
						// Update active role icon
						document.querySelectorAll('.role-icon').forEach(icon => icon.classList.remove('active'));
						document.getElementById(role + 'Icon').classList.add('active');
						
						updateRoleView();
				}

				function switchRole() {
						const roles = ['issuer', 'investor', 'admin'];
						const currentIndex = roles.indexOf(currentRole);
						const nextRole = roles[(currentIndex + 1) % roles.length];
						switchToRole(nextRole);
				}

				// New role switching functions for onboarding buttons
				function switchToInvestorRole() {
						switchToRole('investor');
						showNotification('Switched to Investor view! Submit your KYC application.', 'info');
				}

				function switchToIssuerRole() {
						switchToRole('issuer');
						showNotification('Switched to Issuer view! Review KYC applications and manage investors.', 'info');
				}

				function updateRoleView() {
						const investorView = document.getElementById('investorView');
						const issuerView = document.getElementById('issuerView');
						const adminView = document.getElementById('adminView');
						
						// Hide all views first
						investorView.classList.add('hidden');
						issuerView.classList.add('hidden');
						if (adminView) adminView.classList.add('hidden');
						
						// Show appropriate view based on role
						if (currentRole === 'investor') {
								investorView.classList.remove('hidden');
						} else if (currentRole === 'admin') {
								if (adminView) adminView.classList.remove('hidden');
						} else {
								issuerView.classList.remove('hidden');
						}
						
						// Update module visibility based on role
						updateModuleVisibility();
				}
				
				function updateModuleVisibility() {
						const modules = document.querySelectorAll('.module-card');
						
						modules.forEach(module => {
								const moduleId = module.id;
								
								if (currentRole === 'admin') {
										// Admin can see all modules plus additional admin functions
										module.style.display = 'block';
										
								} else if (currentRole === 'investor') {
										// Investors only see onboarding and distribution modules
										if (moduleId === 'onboardingModule' || moduleId === 'distributionModule') {
												module.style.display = 'block';
										} else {
												module.style.display = 'none';
										}
										
								} else {
										// Issuers see all modules except admin-specific ones
										module.style.display = 'block';
								}
						});
				}

				// Demo functions
				function startTour() {
						let tourMessage = 'üéØ Welcome to the Complete RWA Tokenization Lifecycle!\n\n';
						
						if (currentRole === 'admin') {
								tourMessage += '=== ADMIN: PLATFORM GOVERNANCE & OVERSIGHT ===\n';
								tourMessage += 'üëë You oversee the ENTIRE tokenization ecosystem:\n\n';
								tourMessage += 'üîç MONITORING PHASE:\n';
								tourMessage += '‚Ä¢ Monitor all asset preparations and valuations\n';
								tourMessage += '‚Ä¢ Audit KYC processes and investor compliance\n';
								tourMessage += '‚Ä¢ Oversee token deployments and allocations\n';
								tourMessage += '‚Ä¢ Review corporate actions and asset servicing\n';
								tourMessage += '‚Ä¢ Supervise secondary market activities\n\n';
								tourMessage += '‚öñÔ∏è GOVERNANCE ACTIONS:\n';
								tourMessage += '‚Ä¢ Platform-wide compliance enforcement\n';
								tourMessage += '‚Ä¢ Emergency stops and interventions\n';
								tourMessage += '‚Ä¢ Regulatory reporting and audits\n';
								tourMessage += '‚Ä¢ System integrity and risk management\n\n';
								tourMessage += 'üõ°Ô∏è Your role ensures investor protection and regulatory compliance across all activities.';
								
						} else if (currentRole === 'issuer') {
								tourMessage += '=== ISSUER: COMPLETE ASSET TOKENIZATION LIFECYCLE ===\n';
								tourMessage += 'üè¢ You manage the END-TO-END process:\n\n';
								tourMessage += 'üìã PHASE 1: ASSET PREPARATION\n';
								tourMessage += '‚Ä¢ Identify and valuate real-world assets\n';
								tourMessage += '‚Ä¢ Conduct legal due diligence\n';
								tourMessage += '‚Ä¢ Establish regulatory compliance framework\n';
								tourMessage += '‚Ä¢ Prepare asset documentation\n\n';
								tourMessage += 'üë• PHASE 2: INVESTOR ONBOARDING\n';
								tourMessage += '‚Ä¢ Review and approve KYC applications\n';
								tourMessage += '‚Ä¢ Verify accredited investor status\n';
								tourMessage += '‚Ä¢ Build investor base and cap table\n';
								tourMessage += '‚Ä¢ Establish investor communications\n\n';
								tourMessage += 'ü™ô PHASE 3: TOKEN ISSUANCE\n';
								tourMessage += '‚Ä¢ Deploy ERC3643 compliant smart contracts\n';
								tourMessage += '‚Ä¢ Allocate tokens based on investments\n';
								tourMessage += '‚Ä¢ Create transparent ownership structure\n';
								tourMessage += '‚Ä¢ Ensure regulatory token standards\n\n';
								tourMessage += '‚öôÔ∏è PHASE 4: ASSET SERVICING\n';
								tourMessage += '‚Ä¢ Distribute income (dividends/rent)\n';
								tourMessage += '‚Ä¢ Manage asset lifecycle events\n';
								tourMessage += '‚Ä¢ Execute corporate actions\n';
								tourMessage += '‚Ä¢ Maintain investor relations\n\n';
								tourMessage += 'üìà PHASE 5: SECONDARY DISTRIBUTION\n';
								tourMessage += '‚Ä¢ Enable compliant secondary trading\n';
								tourMessage += '‚Ä¢ Provide liquidity mechanisms\n';
								tourMessage += '‚Ä¢ Monitor market activities\n';
								tourMessage += '‚Ä¢ Ensure continued compliance\n\n';
								tourMessage += 'üíº You create professional, regulated investment products backed by real assets.';
								
						} else {
								tourMessage += '=== INVESTOR: YOUR TOKENIZED ASSET JOURNEY ===\n';
								tourMessage += 'üë§ You participate in the professional asset economy:\n\n';
								tourMessage += 'üìù PHASE 1: QUALIFICATION & ONBOARDING\n';
								tourMessage += '‚Ä¢ Complete KYC verification process\n';
								tourMessage += '‚Ä¢ Demonstrate accredited investor status\n';
								tourMessage += '‚Ä¢ Review available asset opportunities\n';
								tourMessage += '‚Ä¢ Make informed investment decisions\n\n';
								tourMessage += 'üí∞ PHASE 2: TOKEN ACQUISITION\n';
								tourMessage += '‚Ä¢ Receive allocated tokens representing asset ownership\n';
								tourMessage += '‚Ä¢ Understand fractional ownership rights\n';
								tourMessage += '‚Ä¢ Access transparent cap table\n';
								tourMessage += '‚Ä¢ Begin earning from asset performance\n\n';
								tourMessage += 'üìä PHASE 3: ONGOING BENEFITS\n';
								tourMessage += '‚Ä¢ Receive proportional income distributions\n';
								tourMessage += '‚Ä¢ Participate in asset appreciation\n';
								tourMessage += '‚Ä¢ Exercise voting rights on major decisions\n';
								tourMessage += '‚Ä¢ Monitor asset performance reporting\n\n';
								tourMessage += 'üîÑ PHASE 4: LIQUIDITY & EXIT\n';
								tourMessage += '‚Ä¢ Access secondary trading markets\n';
								tourMessage += '‚Ä¢ Trade with other qualified investors\n';
								tourMessage += '‚Ä¢ Exit positions when desired\n';
								tourMessage += '‚Ä¢ Maintain compliance throughout\n\n';
								tourMessage += 'üèÜ You gain access to institutional-quality assets with professional management and regulatory protection.';
						}
						
						tourMessage += '\n\nüí° TIP: Use the guide buttons (üîç) in each module to learn specific concepts and best practices!';
						
						// Use modal instead of alert to prevent content truncation
						showModal('<pre style="font-family: \'Segoe UI\', sans-serif; white-space: pre-wrap; line-height: 1.3; font-size: 0.8rem; color: #f2f2f7;">' + tourMessage + '</pre>');
				}

				// Enhanced interactive tour with step-by-step guidance
				function startInteractiveTour() {
						let steps = [];
						
						if (currentRole === 'admin') {
								steps = [
										'üëë ADMIN OVERVIEW: You have full platform governance',
										'üîç Monitor all asset preparations in RWA Preparation module',
										'üë• Audit KYC processes in Investor Onboarding module', 
										'ü™ô Oversee token deployments in Token Issuance module',
										'‚öôÔ∏è Review corporate actions in Asset Servicing module',
										'üìà Supervise trading in Secondary Distribution module',
										'‚öñÔ∏è Use admin controls for compliance and emergency actions',
										'üõ°Ô∏è Access system logs and generate regulatory reports',
										'üí° Use guide buttons (üîç) in each module for detailed learning'
								];
						} else if (currentRole === 'issuer') {
								steps = [
										'üè¢ ISSUER JOURNEY: You manage the complete tokenization process',
										'üìã STEP 1: Prepare assets in RWA Preparation - valuate and document your real-world assets',
										'üë• STEP 2: Onboard investors - review KYC applications and build your investor base',
										'ü™ô STEP 3: Issue tokens - deploy ERC3643 contracts and allocate tokens to approved investors',
										'‚öôÔ∏è STEP 4: Service assets - execute corporate actions, distribute income, manage lifecycle events',
										'üìà STEP 5: Enable trading - provide secondary market liquidity for your token holders',
										'üìä Monitor performance and maintain investor communications throughout',
										'üîç Use guide buttons in each module to understand tokenization vs traditional methods',
										'üíº You create institutional-grade investment products backed by real assets'
								];
						} else {
								steps = [
										'üë§ INVESTOR JOURNEY: Your path to tokenized asset ownership',
										'üìù STEP 1: Complete KYC verification and demonstrate accredited investor status',
										'üí∞ STEP 2: Receive allocated tokens representing fractional asset ownership',
										'üìä STEP 3: Earn from asset performance - rental income, dividends, appreciation',
										'üîÑ STEP 4: Access secondary markets for liquidity and portfolio management',
										'üìà Monitor your investments through transparent, real-time reporting',
										'‚öñÔ∏è Exercise voting rights on major asset decisions',
										'üîç Use guide buttons to understand your rights and the tokenization benefits',
										'üèÜ Gain access to institutional-quality assets with regulatory protection'
								];
						}
						
						let currentStep = 0;
						
						function showNextStep() {
								if (currentStep < steps.length) {
										const stepMessage = `STEP ${currentStep + 1}/${steps.length}\n\n${steps[currentStep]}\n\n` +
															 (currentStep === steps.length - 1 ? 
															'üéâ Tour completed! Start exploring the platform.' : 
															'Click OK for next step, or Cancel to exit tour.');
										
										if (confirm(stepMessage)) {
												currentStep++;
												showNextStep();
										}
								}
						}
						
						showNextStep();
				}

				function showRoleInfo() {
						let content = '<h2>Role Comparison</h2>';
						content += '<table class="data-table">';
						content += '<thead><tr><th>Feature</th><th>Admin</th><th>Issuer</th><th>Investor</th></tr></thead>';
						content += '<tbody>';
						content += '<tr><td>RWA Preparation</td><td>‚úÖ View All</td><td>‚úÖ Create/Manage</td><td>‚ùå</td></tr>';
						content += '<tr><td>KYC Management</td><td>‚úÖ Audit All</td><td>‚úÖ Review Own</td><td>‚úÖ Submit</td></tr>';
						content += '<tr><td>Token Issuance</td><td>‚úÖ Monitor All</td><td>‚úÖ Deploy/Issue</td><td>‚ùå</td></tr>';
						content += '<tr><td>Corporate Actions</td><td>‚úÖ Override All</td><td>‚úÖ Own Tokens</td><td>‚ùå</td></tr>';
						content += '<tr><td>Secondary Trading</td><td>‚úÖ Monitor All</td><td>‚úÖ Enable/Disable</td><td>‚úÖ Trade</td></tr>';
						content += '<tr><td>Platform Controls</td><td>‚úÖ Full Control</td><td>‚ùå</td><td>‚ùå</td></tr>';
						content += '<tr><td>Compliance Audit</td><td>‚úÖ Full Access</td><td>‚úÖ Own Assets</td><td>‚ùå</td></tr>';
						content += '<tr><td>Emergency Stop</td><td>‚úÖ</td><td>‚ùå</td><td>‚ùå</td></tr>';
						content += '</tbody></table>';
						
						content += '<div class="notification">';
						content += '<strong>Current Role:</strong> ' + currentRole.charAt(0).toUpperCase() + currentRole.slice(1);
						content += '<br><strong>Permissions:</strong> Click the role icons in the header to switch between roles and experience different capabilities.';
						content += '</div>';
						
						showModal(content);
				}

				function resetDemo() {
						rwas = [];
						investors = [];
						tokens = [];
						trades = [];
						notifications = [];
						updateDashboard();
						updateAllProgress();
						document.getElementById('contractStatus').innerHTML = '<strong>Contract Status:</strong> Not deployed';
				}

				function loadSampleData() {
						rwas = [...sampleRWAs];
						investors = [...sampleInvestors];
						updateDashboard();
						updateAllProgress();
						updateAssetSelectors();
						
						// Auto-select the first prepared asset in token issuance
						const assetSelector = document.getElementById('assetSelector');
						if (assetSelector && rwas.length > 0) {
								const firstAsset = rwas.find(rwa => rwa.status === 'prepared');
								if (firstAsset) {
										assetSelector.value = firstAsset.tokenSymbol;
										// Trigger the change event to populate asset value and calculate token supply
										const changeEvent = new Event('change');
										assetSelector.dispatchEvent(changeEvent);
								}
						}
						
						showNotification('Sample data loaded successfully! First asset auto-selected in Token Issuance.', 'success');
				}

				// RWA Preparation functions
				function prepareRWA() {
						const assetType = document.getElementById('assetType').value;
						const description = document.getElementById('assetDescription').value;
						const tokenSymbol = document.getElementById('assetTokenSymbol').value.toUpperCase();
						const jurisdiction = document.getElementById('jurisdiction').value;
						const valuation = parseFloat(document.getElementById('valuationAmount').value);
						const date = document.getElementById('valuationDate').value;

						if (!assetType || !description || !tokenSymbol || !jurisdiction || !valuation || !date) {
								alert('Please fill in all fields');
								return;
						}

						// Check for duplicate token symbols
						const existingSymbol = rwas.find(rwa => rwa.tokenSymbol === tokenSymbol);
						if (existingSymbol) {
								alert('Token symbol already exists. Please choose a different one.');
								return;
						}

						const rwa = {
								id: rwas.length + 1,
								type: assetType,
								description,
								tokenSymbol,
								jurisdiction,
								valuation,
								date,
								status: 'prepared'
						};

						rwas.push(rwa);
						updateDashboard();
						updateAssetSelectors();
						updateProgress('preparation', 25);
						showNotification('RWA prepared successfully with embedded valuation data!', 'success');
						
						// Clear form
						document.getElementById('assetType').value = '';
						document.getElementById('assetDescription').value = '';
						document.getElementById('assetTokenSymbol').value = '';
						document.getElementById('jurisdiction').value = '';
						document.getElementById('valuationAmount').value = '';
						document.getElementById('valuationDate').value = '';
				}

				function viewRWAsList() {
						let content = '<h2>Prepared RWAs</h2>';
						if (rwas.length === 0) {
								content += '<p>No RWAs prepared yet.</p>';
						} else {
								content += '<table class="data-table"><thead><tr><th>ID</th><th>Type</th><th>Description</th><th>Valuation</th><th>Status</th></tr></thead><tbody>';
								rwas.forEach(rwa => {
										content += `<tr>
												<td>${rwa.id}</td>
												<td>${rwa.type.replace('-', ' ').toUpperCase()}</td>
												<td>${rwa.description.substring(0, 50)}...</td>
												<td>$${rwa.valuation.toLocaleString()}</td>
												<td><span class="status-indicator active"></span>${rwa.status}</td>
										</tr>`;
								});
								content += '</tbody></table>';
						}
						showModal(content);
				}

				// Investor Onboarding functions
				function submitKYC() {
						const name = document.getElementById('investorName').value;
						const wallet = document.getElementById('investorWallet').value;
						const investment = parseFloat(document.getElementById('investmentAmount').value);

						if (!name || !wallet || !investment) {
								alert('Please fill in all fields');
								return;
						}

						// Basic wallet address validation
						//if (!wallet.match(/^0x[a-fA-F0-9]{40}$/)) {
						if (!wallet.match(/^0x[a-fA-F0-9]/)) {
								alert('Please enter a valid Ethereum wallet address');
								return;
						}

						const investor = {
								id: investors.length + 1,
								name,
								wallet,
								investment,
								status: 'pending',
								kycDate: new Date().toISOString().split('T')[0]
						};

						investors.push(investor);
						updateDashboard();
						updateProgress('onboarding', 50);
						showNotification('KYC application submitted successfully!', 'success');
						
						// Clear form
						document.getElementById('investorName').value = '';
						document.getElementById('investorWallet').value = '';
						document.getElementById('investmentAmount').value = '';
						
						// Update KYC queue
						updateKYCQueue();
				}

				function reviewKYC() {
						const pendingInvestors = investors.filter(inv => inv.status === 'pending');
						
						if (pendingInvestors.length === 0) {
								alert('No pending KYC applications');
								return;
						}

						let content = '<h2>KYC Review Queue</h2>';
						content += '<table class="data-table"><thead><tr><th>Name</th><th>Email</th><th>Investment</th><th>Date</th><th>Action</th></tr></thead><tbody>';
						
						pendingInvestors.forEach(investor => {
								content += `<tr>
										<td>${investor.name}</td>
										<td>${investor.email}</td>
										<td>$${investor.investment.toLocaleString()}</td>
										<td>${investor.kycDate}</td>
										<td>
												<button class="btn" onclick="approveKYC(${investor.id})">Approve</button>
												<button class="btn danger" onclick="rejectKYC(${investor.id})">Reject</button>
										</td>
								</tr>`;
						});
						content += '</tbody></table>';
						showModal(content);
				}

				function approveKYC(investorId) {
						const investor = investors.find(inv => inv.id === investorId);
						if (investor) {
								investor.status = 'approved';
								updateDashboard();
								updateKYCQueue();
								closeModal();
								showNotification(`${investor.name} approved successfully!`, 'success');
						}
				}

				function rejectKYC(investorId) {
						const investor = investors.find(inv => inv.id === investorId);
						if (investor) {
								investor.status = 'rejected';
								updateKYCQueue();
								closeModal();
								showNotification(`${investor.name} rejected`, 'warning');
						}
				}

				function updateKYCQueue() {
						const pendingCount = investors.filter(inv => inv.status === 'pending').length;
						document.getElementById('kycQueue').innerHTML = `
								<span class="status-indicator ${pendingCount > 0 ? 'pending' : 'active'}"></span>
								<strong>KYC Queue:</strong> ${pendingCount} pending applications
						`;
				}

				function viewInvestorsList() {
						let content = '<h2>Investor List</h2>';
						if (investors.length === 0) {
								content += '<p>No investors onboarded yet.</p>';
						} else {
								content += '<table class="data-table"><thead><tr><th>Name</th><th>Email</th><th>Investment</th><th>Status</th><th>KYC Date</th></tr></thead><tbody>';
								investors.forEach(investor => {
										const statusClass = investor.status === 'approved' ? 'active' : investor.status === 'pending' ? 'pending' : 'inactive';
										content += `<tr>
												<td>${investor.name}</td>
												<td>${investor.email}</td>
												<td>$${investor.investment.toLocaleString()}</td>
												<td><span class="status-indicator ${statusClass}"></span>${investor.status}</td>
												<td>${investor.kycDate}</td>
										</tr>`;
								});
								content += '</tbody></table>';
						}
						showModal(content);
				}

				// Token Issuance functions
				function deployContract() {
						const selectedAsset = document.getElementById('assetSelector').value;
						const tokenName = document.getElementById('tokenName').value;
						const supply = document.getElementById('tokenSupply').value;
						const price = document.getElementById('tokenPrice').value;
						const assetValue = document.getElementById('assetValue').value;

						if (!selectedAsset || !tokenName || !supply || !price || !assetValue) {
								alert('Please fill in all token details');
								return;
						}

						// Validate that the calculation is correct
						const expectedSupply = Math.floor(parseFloat(assetValue) / parseFloat(price));
						if (parseInt(supply) !== expectedSupply) {
								alert('Token supply calculation mismatch. Please check the values.');
								return;
						}

						const asset = rwas.find(rwa => rwa.tokenSymbol === selectedAsset);
						if (!asset) {
								alert('Selected asset not found');
								return;
						}

						// Simulate contract deployment with realistic data
						const contractAddress = '0x' + Math.random().toString(16).substr(2, 40);
						const transactionHash = '0x' + Math.random().toString(16).substr(2, 64);
						const blockNumber = Math.floor(Math.random() * 1000000) + 18000000;
						
						// Console log simulating smart contract constructor (kept for debugging)
						/*console.log('SMART CONTRACT DEPLOYMENT');
						console.log('Contract Address:', contractAddress);
						console.log('Token Name:', tokenName);
						console.log('Token Symbol:', asset.tokenSymbol);
						console.log('Asset Value:', '$' + parseFloat(assetValue).toLocaleString());
						console.log('Token Price:', '$' + parseFloat(price).toLocaleString());
						console.log('Total Supply:', parseInt(supply).toLocaleString() + ' tokens');
						console.log('Calculation:', `$${parseFloat(assetValue).toLocaleString()} √∑ $${parseFloat(price).toLocaleString()} = ${parseInt(supply).toLocaleString()} tokens`);
						console.log('Asset Backing:', '$' + asset.valuation.toLocaleString());
						console.log('Transaction Hash:', transactionHash);
						console.log('Gas Used: 2,847,392');
						console.log('Block Number:', blockNumber);*/

						// Create modal popup with deployment information
						let deploymentInfo = `<h2>üöÄ Smart Contract Deployment Success</h2>
								<div class="notification success">
										<strong>ERC3643 Token Contract Successfully Deployed!</strong>
								</div>
								
								<div style="background: #000; color: #00ff00; padding: 20px; border-radius: 8px; font-family: 'Courier New', monospace; margin: 15px 0;">
										<div style="color: #ffffff; font-weight: bold; margin-bottom: 10px;">üöÄ SMART CONTRACT DEPLOYMENT</div>
										<div style="color: #00ff00;">================================</div>
										<div><strong>Contract Address:</strong> <span style="color: #00bfff;">${contractAddress}</span></div>
										<div><strong>Token Name:</strong> ${tokenName}</div>
										<div><strong>Token Symbol:</strong> <span style="color: #ffa500;">${asset.tokenSymbol}</span></div>
										<div><strong>Asset Value:</strong> <span style="color: #32cd32;">$${parseFloat(assetValue).toLocaleString()}</span></div>
										<div><strong>Token Price:</strong> <span style="color: #32cd32;">$${parseFloat(price).toLocaleString()}</span></div>
										<div><strong>Total Supply:</strong> <span style="color: #ffa500;">${parseInt(supply).toLocaleString()} tokens</span></div>
										<div><strong>Calculation:</strong> $${parseFloat(assetValue).toLocaleString()} √∑ $${parseFloat(price).toLocaleString()} = ${parseInt(supply).toLocaleString()} tokens</div>
										<div><strong>Asset Backing:</strong> <span style="color: #32cd32;">$${asset.valuation.toLocaleString()}</span></div>
										<div><strong>Transaction Hash:</strong> <span style="color: #00bfff;">${transactionHash}</span></div>
										<div><strong>Gas Used:</strong> 2,847,392</div>
										<div><strong>Block Number:</strong> ${blockNumber}</div>
										<div><strong>ERC3643 Compliance:</strong> <span style="color: #32cd32;">‚úÖ Enabled</span></div>
										<div style="color: #00ff00;">================================</div>
								</div>

								<div class="notification">
										<strong>Next Steps:</strong><br>
										‚Ä¢ Contract is now live on the blockchain<br>
										‚Ä¢ Ready for token allocation to approved investors<br>
										‚Ä¢ All transfers will be compliance-checked<br>
										‚Ä¢ Investors can begin receiving asset benefits
								</div>

								<div class="notification">
										<strong>Technical Details:</strong><br>
										‚Ä¢ Standard: ERC3643 (Security Token)<br>
										‚Ä¢ Network: Ethereum Mainnet<br>
										‚Ä¢ Compliance: Built-in KYC/AML checks<br>
										‚Ä¢ Governance: Smart contract controlled
								</div>`;

						document.getElementById('contractStatus').innerHTML = `
								<strong>Contract Status:</strong> Deployed ‚úÖ<br>
								<small>Address: ${contractAddress}</small><br>
								<small>Token: ${asset.tokenSymbol} (${tokenName})</small>
						`;

						// Store deployment info
						asset.deployed = {
								contractAddress,
								tokenName,
								supply,
								price,
								transactionHash
						};

						// Store the currently selected asset to preserve it after updating selectors
						const currentlySelectedAsset = selectedAsset;
						
						updateAssetSelectors();
						
						// Restore the selected asset after updateAssetSelectors() rebuilds the dropdown
						const assetSelector = document.getElementById('assetSelector');
						if (assetSelector && currentlySelectedAsset) {
								assetSelector.value = currentlySelectedAsset;
								// Trigger change event to maintain asset value and calculated supply
								const changeEvent = new Event('change');
								assetSelector.dispatchEvent(changeEvent);
						}
						
						updateProgress('issuance', 75);
						
						// Show the deployment info modal
						showModal(deploymentInfo);
						
						showNotification('ERC3643 contract deployed successfully! Asset selection preserved for next action.', 'success');
				}

				function allocateTokens() {
						const selectedAsset = document.getElementById('assetSelector').value;
						const approvedInvestors = investors.filter(inv => inv.status === 'approved');
						
						if (!selectedAsset) {
								alert('Please select an asset first');
								return;
						}
						
						if (approvedInvestors.length === 0) {
								alert('No approved investors to allocate tokens to');
								return;
						}

						const asset = rwas.find(rwa => rwa.tokenSymbol === selectedAsset);
						if (!asset || !asset.deployed) {
								alert('Asset not found or contract not deployed');
								return;
						}

						const tokenPrice = parseFloat(document.getElementById('tokenPrice').value) || 100;
						
						console.log('üí∏ TOKEN ALLOCATION TRANSACTIONS');
						console.log('===================================');
						console.log('Asset:', asset.tokenSymbol, '-', asset.deployed.tokenName);
						console.log('Contract:', asset.deployed.contractAddress);
						console.log('-----------------------------------');
						
						approvedInvestors.forEach((investor, index) => {
								const tokensAllocated = Math.floor(investor.investment / tokenPrice);
								const transactionHash = '0x' + Math.random().toString(16).substr(2, 64);
								
								// Console log for each transfer transaction
								console.log(`Transfer #${index + 1}:`);
								console.log('  To:', investor.wallet);
								console.log('  Recipient:', investor.name);
								console.log('  Amount:', tokensAllocated, asset.tokenSymbol);
								console.log('  Value: $' + (tokensAllocated * tokenPrice).toLocaleString());
								console.log('  TX Hash:', transactionHash);
								console.log('  Gas Used: 51,942');
								console.log('  ---');
								
								const token = {
										id: tokens.length + 1,
										investorId: investor.id,
										investorName: investor.name,
										investorWallet: investor.wallet,
										tokenSymbol: asset.tokenSymbol,
										tokensAllocated,
										tokenPrice,
										totalValue: tokensAllocated * tokenPrice,
										transactionHash
								};
								tokens.push(token);
						});

						console.log('===================================');
						console.log('‚úÖ All allocations completed successfully');
						
						updateDashboard();
						updateProgress('issuance', 100);
						showNotification('Tokens allocated to all approved investors! Check console for transaction details.', 'success');
				}

				function viewCapTable() {
						let content = '<h2>Capitalization Table</h2>';
						if (tokens.length === 0) {
								content += '<p>No tokens allocated yet.</p>';
						} else {
								const totalTokens = tokens.reduce((sum, token) => sum + token.tokensAllocated, 0);
								const totalValue = tokens.reduce((sum, token) => sum + token.totalValue, 0);
								
								content += `<div class="notification">
										<strong>Summary:</strong> ${totalTokens} tokens worth $${totalValue.toLocaleString()} allocated
								</div>`;
								
								content += '<table class="data-table"><thead><tr><th>Investor</th><th>Tokens</th><th>Price</th><th>Total Value</th><th>Percentage</th></tr></thead><tbody>';
								tokens.forEach(token => {
										const percentage = ((token.tokensAllocated / totalTokens) * 100).toFixed(2);
										content += `<tr>
												<td>${token.investorName}</td>
												<td>${token.tokensAllocated}</td>
												<td>$${token.tokenPrice}</td>
												<td>$${token.totalValue.toLocaleString()}</td>
												<td>${percentage}%</td>
										</tr>`;
								});
								content += '</tbody></table>';
						}
						showModal(content);
				}

				// Servicing functions
				function executeCorporateAction() {
						const action = document.getElementById('corporateAction').value;
						const parameter = document.getElementById('actionParameter').value;
						const message = document.getElementById('investorMessage').value;

						if (!action || !parameter) {
								alert('Please select an action and enter the required parameter');
								return;
						}

						// Simulate corporate action execution with realistic scenarios
						let actionMessage = '';
						let investorImpact = '';
						
						switch (action) {
								case 'dividend':
										actionMessage = `Distributed $${parameter} in rental income to all token holders`;
										investorImpact = 'Quarterly rental income distributed proportionally based on token ownership';
										break;
								case 'mint':
										actionMessage = `Minted ${parameter} new tokens due to asset appreciation from $${Math.floor(Math.random() * 1000000)} property improvements`;
										investorImpact = 'Existing token holders receive proportional bonus tokens reflecting increased asset value';
										break;
								case 'burn':
										actionMessage = `Burned ${parameter} tokens following partial asset liquidation`;
										investorImpact = 'Liquidation proceeds of $' + (parameter * 1000).toLocaleString() + ' distributed to token holders';
										break;
								case 'pause':
										actionMessage = 'All token transfers temporarily paused for regulatory compliance review';
										investorImpact = 'Trading suspended - estimated duration: 5-10 business days';
										break;
								case 'force-transfer':
										actionMessage = `Executed court-ordered transfer of tokens to address ${parameter}`;
										investorImpact = 'Legal compliance transfer - investor rights protected under regulations';
										break;
								case 'split':
										actionMessage = `Executed ${parameter}:1 token split - all holders receive additional tokens`;
										investorImpact = `Token count multiplied by ${parameter}, price adjusted proportionally`;
										break;
						}

						updateProgress('servicing', 60);
						showNotification(actionMessage + ' successfully!', 'success');
						
						// Show detailed impact modal
						let content = `<h2>Corporate Action Executed</h2>
								<div class="notification success">
										<strong>Action:</strong> ${actionMessage}
								</div>
								<div class="notification">
										<strong>Investor Impact:</strong> ${investorImpact}
								</div>`;
						
						if (message) {
								content += `<div class="notification">
										<strong>Message Sent to Investors:</strong><br>
										"${message}"
								</div>`;
						}
						
						content += `<div class="notification">
								<strong>Next Steps:</strong><br>
								‚Ä¢ All investors will be notified via email<br>
								‚Ä¢ Updated ownership certificates will be issued<br>
								‚Ä¢ Compliance documentation will be filed<br>
								‚Ä¢ Tax implications will be communicated
						</div>`;
						
						showModal(content);
						
						// Clear form
						document.getElementById('corporateAction').value = '';
						document.getElementById('actionParameter').value = '';
						document.getElementById('investorMessage').value = '';
						document.getElementById('actionHelp').textContent = 'Select an action above for specific guidance';
				}

				function generateReport() {
						const reportData = {
								rwas: rwas.length,
								investors: investors.length,
								tokens: tokens.reduce((sum, token) => sum + token.tokensAllocated, 0),
								totalValue: tokens.reduce((sum, token) => sum + token.totalValue, 0),
								trades: trades.length
						};

						let content = `<h2>Audit Report</h2>
								<div class="notification">
										<strong>Report Generated:</strong> ${new Date().toLocaleString()}
								</div>
								<table class="data-table">
										<tr><td>Total RWAs Prepared</td><td>${reportData.rwas}</td></tr>
										<tr><td>Total Investors</td><td>${reportData.investors}</td></tr>
										<tr><td>Tokens Issued</td><td>${reportData.tokens}</td></tr>
										<tr><td>Total Asset Value</td><td>$${reportData.totalValue.toLocaleString()}</td></tr>
										<tr><td>Secondary Trades</td><td>${reportData.trades}</td></tr>
								</table>`;
						
						showModal(content);
				}

				function openMessaging() {
						let content = '<h2>Investor Messaging System</h2>';
						content += '<div class="form-group"><label>Select Investor</label><select>';
						investors.forEach(investor => {
								content += `<option value="${investor.id}">${investor.name}</option>`;
						});
						content += '</select></div>';
						content += '<div class="form-group"><label>Message</label><textarea placeholder="Enter your message..."></textarea></div>';
						content += '<button class="btn">Send Message</button>';
						showModal(content);
				}

				// Distribution functions
				function toggleTrading() {
						const status = document.getElementById('tradingStatus').value;
						const tradingOptions = document.getElementById('tradingOptions');
						
						if (status === 'enabled') {
								tradingOptions.classList.remove('hidden');
								updateProgress('distribution', 80);
								showNotification('Trading enabled for all tokens!', 'success');
						} else {
								tradingOptions.classList.add('hidden');
						}
				}

				function postTrade() {
						const tradeType = document.getElementById('tradeType').value;
						const amount = parseFloat(document.getElementById('tradeAmount').value);
						const price = parseFloat(document.getElementById('tradePrice').value);

						if (!tradeType || !amount || !price) {
								alert('Please fill in all trade details');
								return;
						}

						const trade = {
								id: trades.length + 1,
								type: tradeType,
								amount,
								price,
								totalValue: amount * price,
								timestamp: new Date().toLocaleString(),
								status: 'posted'
						};

						trades.push(trade);
						updateDashboard();
						updateProgress('distribution', 100);
						showNotification('Trade offer posted successfully!', 'success');
						
						// Clear form
						document.getElementById('tradeAmount').value = '';
						document.getElementById('tradePrice').value = '';
				}

				function viewTradeHistory() {
						let content = '<h2>Trade History</h2>';
						if (trades.length === 0) {
								content += '<p>No trades posted yet.</p>';
						} else {
								content += '<table class="data-table"><thead><tr><th>ID</th><th>Type</th><th>Amount</th><th>Price</th><th>Total</th><th>Time</th><th>Status</th></tr></thead><tbody>';
								trades.forEach(trade => {
										content += `<tr>
												<td>${trade.id}</td>
												<td>${trade.type.toUpperCase()}</td>
												<td>${trade.amount}</td>
												<td>$${trade.price}</td>
												<td>$${trade.totalValue.toLocaleString()}</td>
												<td>${trade.timestamp}</td>
												<td><span class="status-indicator active"></span>${trade.status}</td>
										</tr>`;
								});
								content += '</tbody></table>';
						}
						showModal(content);
				}

				// Utility functions
				function updateDashboard() {
						document.getElementById('totalRWAs').textContent = rwas.length;
						document.getElementById('totalInvestors').textContent = investors.length;
						const totalTokenValue = tokens.reduce((sum, token) => sum + token.totalValue, 0);
						document.getElementById('totalTokens').textContent = '$' + totalTokenValue.toLocaleString();
						document.getElementById('totalTrades').textContent = trades.length;
				}

				function updateProgress(module, percentage) {
						document.getElementById(module + 'Progress').style.width = percentage + '%';
				}

				function updateAllProgress() {
						updateProgress('preparation', rwas.length > 0 ? 25 : 0);
						updateProgress('onboarding', investors.length > 0 ? 50 : 0);
						updateProgress('issuance', tokens.length > 0 ? 100 : 0);
						updateProgress('servicing', 0);
						updateProgress('distribution', trades.length > 0 ? 100 : 0);
				}

				// Update asset selectors across modules
				function updateAssetSelectors() {
						const preparedAssets = rwas.filter(rwa => rwa.status === 'prepared');
						const deployedAssets = rwas.filter(rwa => rwa.deployed);
						
						// Update asset selector in token issuance
						const assetSelector = document.getElementById('assetSelector');
						if (assetSelector) {
								assetSelector.innerHTML = '<option value="">Select prepared RWA asset</option>';
								preparedAssets.forEach(asset => {
										assetSelector.innerHTML += `<option value="${asset.tokenSymbol}">${asset.tokenSymbol} - ${asset.description.substring(0, 30)}...</option>`;
								});
								
								// Add event listener for asset selection to populate asset value
								assetSelector.onchange = function() {
										const selectedAsset = rwas.find(rwa => rwa.tokenSymbol === this.value);
										const assetValueInput = document.getElementById('assetValue');
										if (selectedAsset && assetValueInput) {
												assetValueInput.value = selectedAsset.valuation;
												calculateTokenSupply();
										} else if (assetValueInput) {
												assetValueInput.value = '';
												calculateTokenSupply();
										}
								};
						}
						
						// Update servicing asset selector
						const servicingSelector = document.getElementById('servicingAssetSelector');
						if (servicingSelector) {
								servicingSelector.innerHTML = '<option value="">Select deployed token to service</option>';
								deployedAssets.forEach(asset => {
										servicingSelector.innerHTML += `<option value="${asset.tokenSymbol}">${asset.tokenSymbol} - ${asset.deployed.tokenName}</option>`;
								});
						}
						
						// Update distribution asset selector
						const distributionSelector = document.getElementById('distributionAssetSelector');
						if (distributionSelector) {
								distributionSelector.innerHTML = '<option value="">Select token for secondary trading</option>';
								deployedAssets.forEach(asset => {
										distributionSelector.innerHTML += `<option value="${asset.tokenSymbol}">${asset.tokenSymbol} - ${asset.deployed.tokenName}</option>`;
								});
						}
				}

				// Calculate token supply automatically based on asset value and token price
				function calculateTokenSupply() {
						const assetValue = parseFloat(document.getElementById('assetValue').value) || 0;
						const tokenPrice = parseFloat(document.getElementById('tokenPrice').value) || 0;
						const tokenSupplyInput = document.getElementById('tokenSupply');
						const calculationDisplay = document.getElementById('calculationDisplay');
						const calculationFormula = document.getElementById('calculationFormula');
						
						if (assetValue > 0 && tokenPrice > 0) {
								const tokenSupply = Math.floor(assetValue / tokenPrice);
								tokenSupplyInput.value = tokenSupply;
								
								// Show calculation breakdown
								calculationDisplay.style.display = 'block';
								calculationFormula.innerHTML = `$${assetValue.toLocaleString()} √∑ $${tokenPrice.toLocaleString()} = ${tokenSupply.toLocaleString()} tokens`;
						} else {
								tokenSupplyInput.value = '';
								calculationDisplay.style.display = 'none';
						}
				}

				// Set today's date as default for valuation date
				function setDefaultDate() {
						const today = new Date();
						const formattedDate = today.toISOString().split('T')[0];
						const valuationDateInput = document.getElementById('valuationDate');
						if (valuationDateInput && !valuationDateInput.value) {
								valuationDateInput.value = formattedDate;
						}
				}

				function showNotification(message, type = 'info') {
						const notification = document.createElement('div');
						notification.className = `notification ${type}`;
						notification.textContent = message;
						notification.style.position = 'fixed';
						notification.style.top = '20px';
						notification.style.right = '20px';
						notification.style.zIndex = '9999';
						notification.style.maxWidth = '300px';
						
						document.body.appendChild(notification);
						
						setTimeout(() => {
								notification.remove();
						}, 3000);
				}

				function showModal(content) {
						document.getElementById('modalBody').innerHTML = content;
						document.getElementById('modal').classList.remove('hidden');
						console.log('Modal visibility toggled:', document.getElementById('modal').classList.contains('hidden') ? 'Hidden' : 'Visible');
				}

				function closeModal() {
						const modal = document.getElementById('modal');
						console.log('Before adding hidden class:', modal.classList);
						modal.classList.add('hidden');
						console.log('After adding hidden class:', modal.classList);
						console.log('Modal visibility toggled:', modal.classList.contains('hidden') ? 'Hidden' : 'Visible');
				}

				// Initialize KYC queue on load
				updateKYCQueue();

				// Admin-specific functions
				function executeAdminAction() {
						const action = document.getElementById('adminAction').value;
						
						if (!action) {
								alert('Please select an admin action');
								return;
						}

						let message = '';
						switch (action) {
								case 'audit-all':
										message = 'Full platform audit initiated. All transactions, users, and assets are being reviewed for compliance.';
										break;
								case 'compliance-check':
										message = 'Compliance check completed. All KYC documents and regulatory requirements verified.';
										break;
								case 'freeze-platform':
										message = 'Platform temporarily frozen. All trading and new registrations suspended pending review.';
										break;
								case 'reset-platform':
										if (confirm('This will reset all demo data. Are you sure?')) {
												resetDemo();
												message = 'Platform reset completed. All demo data cleared.';
										} else {
												return;
										}
										break;
						}

						showNotification(message, 'warning');
						document.getElementById('adminAction').value = '';
				}

				function viewSystemLogs() {
						let content = '<h2>System Activity Logs</h2>';
						content += '<div class="notification">Real-time platform monitoring and audit trail</div>';
						content += '<table class="data-table">';
						content += '<thead><tr><th>Timestamp</th><th>User Role</th><th>Action</th><th>Status</th></tr></thead>';
						content += '<tbody>';
						
						// Generate sample log entries
						const logEntries = [
								{ time: '2025-08-16 10:30:15', role: 'Issuer', action: 'RWA Preparation: Real Estate Asset', status: 'Success' },
								{ time: '2025-08-16 10:25:42', role: 'Investor', action: 'KYC Submission: John Smith', status: 'Pending' },
								{ time: '2025-08-16 10:20:33', role: 'Admin', action: 'Compliance Audit: Platform Review', status: 'Completed' },
								{ time: '2025-08-16 10:15:18', role: 'Issuer', action: 'Token Deployment: ERC3643 Contract', status: 'Success' },
								{ time: '2025-08-16 10:10:55', role: 'Investor', action: 'Secondary Trade: 1000 tokens', status: 'Success' }
						];
						
						logEntries.forEach(log => {
								const statusClass = log.status === 'Success' ? 'active' : log.status === 'Pending' ? 'pending' : 'inactive';
								content += `<tr>
										<td>${log.time}</td>
										<td>${log.role}</td>
										<td>${log.action}</td>
										<td><span class="status-indicator ${statusClass}"></span>${log.status}</td>
								</tr>`;
						});
						
						content += '</tbody></table>';
						showModal(content);
				}

				function viewAllAssets() {
						let content = '<h2>Platform Asset Overview</h2>';
						content += '<div class="notification">Administrative view of all assets across the platform</div>';
						
						if (rwas.length === 0) {
								content += '<p>No assets registered on the platform yet.</p>';
						} else {
								const totalValuation = rwas.reduce((sum, rwa) => sum + rwa.valuation, 0);
								content += `<div class="notification success">
										<strong>Platform Summary:</strong> ${rwas.length} assets worth $${totalValuation.toLocaleString()} registered
								</div>`;
								
								content += '<table class="data-table">';
								content += '<thead><tr><th>Asset ID</th><th>Type</th><th>Jurisdiction</th><th>Valuation</th><th>Status</th><th>Admin Actions</th></tr></thead>';
								content += '<tbody>';
								
								rwas.forEach(rwa => {
										content += `<tr>
												<td>RWA-${rwa.id.toString().padStart(4, '0')}</td>
												<td>${rwa.type.replace('-', ' ').toUpperCase()}</td>
												<td>${rwa.jurisdiction.toUpperCase()}</td>
												<td>$${rwa.valuation.toLocaleString()}</td>
												<td><span class="status-indicator active"></span>${rwa.status}</td>
												<td>
														<button class="btn" onclick="auditAsset(${rwa.id})">Audit</button>
														<button class="btn danger" onclick="flagAsset(${rwa.id})">Flag</button>
												</td>
										</tr>`;
								});
								content += '</tbody></table>';
						}
						
						showModal(content);
				}

				function emergencyStop() {
						if (confirm('EMERGENCY STOP: This will immediately halt all platform operations. Continue?')) {
								showNotification('üö® EMERGENCY STOP ACTIVATED - All platform operations suspended', 'warning');
								// Disable all buttons except admin controls
								const buttons = document.querySelectorAll('button:not(.close-modal)');
								buttons.forEach(btn => {
										if (!btn.onclick || !btn.onclick.toString().includes('admin') && !btn.onclick.toString().includes('switchToRole')) {
												btn.disabled = true;
												btn.style.opacity = '0.5';
										}
								});
						}
				}

				function auditAsset(assetId) {
						const asset = rwas.find(rwa => rwa.id === assetId);
						if (asset) {
								showNotification(`Asset RWA-${assetId.toString().padStart(4, '0')} audit completed - No compliance issues found`, 'success');
						}
						closeModal();
				}

				function flagAsset(assetId) {
						const asset = rwas.find(rwa => rwa.id === assetId);
						if (asset && confirm(`Flag asset RWA-${assetId.toString().padStart(4, '0')} for compliance review?`)) {
								asset.status = 'flagged';
								showNotification(`Asset RWA-${assetId.toString().padStart(4, '0')} flagged for compliance review`, 'warning');
								closeModal();
						}
				}

				// New educational functions
				function showTokenVsICO() {
						let content = `<h2>üîç RWA Token Issuance vs ICO Comparison</h2>
								<table class="data-table">
								<thead><tr><th>Aspect</th><th>RWA Token Issuance</th><th>ICO (Initial Coin Offering)</th></tr></thead>
								<tbody>
								<tr><td><strong>Purpose</strong></td><td>Fractional ownership of real assets</td><td>Fundraising for new projects</td></tr>
								<tr><td><strong>Asset Backing</strong></td><td>‚úÖ Backed by real, valued assets</td><td>‚ùå Usually utility tokens</td></tr>
								<tr><td><strong>Investor Type</strong></td><td>KYC-approved accredited investors</td><td>General public</td></tr>
								<tr><td><strong>Regulatory Status</strong></td><td>Securities compliant (ERC3643)</td><td>Often unregulated</td></tr>
								<tr><td><strong>Value Basis</strong></td><td>Asset valuation & performance</td><td>Speculation & adoption</td></tr>
								<tr><td><strong>Distribution</strong></td><td>Private placement</td><td>Public offering</td></tr>
								<tr><td><strong>Rights</strong></td><td>Ownership, dividends, voting</td><td>Platform usage rights</td></tr>
								<tr><td><strong>Risk Profile</strong></td><td>Asset performance risk</td><td>Project execution risk</td></tr>
								</tbody></table>

								<div class="notification success">
										<strong>Key Difference:</strong> RWA tokens are like buying shares in a property or asset, while ICOs are like crowdfunding for a new business idea.
								</div>

								<div class="notification">
										<strong>Example:</strong><br>
										‚Ä¢ <strong>RWA Token:</strong> $10M office building ‚Üí 10,000 tokens at $1,000 each ‚Üí You own 0.01% of the building<br>
										‚Ä¢ <strong>ICO:</strong> New gaming platform ‚Üí Sell utility tokens ‚Üí Hope the platform succeeds
								</div>`;
						
						showModal(content);
				}

				function showServicingExamples() {
						let content = `<h2>ÔøΩ Real-World Token Servicing Examples</h2>

								<div class="notification">
										<strong>Scenario 1: Commercial Real Estate ($50M Office Building)</strong>
								</div>
								<table class="data-table">
								<tr><td><strong>Monthly Rental Income</strong></td><td>Distribute $200K/month to token holders proportionally</td></tr>
								<tr><td><strong>Building Renovation</strong></td><td>$5M improvement ‚Üí Mint 5,000 new tokens (asset appreciation)</td></tr>
								<tr><td><strong>Partial Sale</strong></td><td>Sell parking garage for $8M ‚Üí Burn 8,000 tokens, distribute proceeds</td></tr>
								<tr><td><strong>Regulatory Audit</strong></td><td>Pause transfers during 2-week compliance review</td></tr>
								</table>

								<div class="notification">
										<strong>Scenario 2: Art Collection ($2.5M Contemporary Pieces)</strong>
								</div>
								<table class="data-table">
								<tr><td><strong>Artwork Appreciation</strong></td><td>Piece valued at +30% ‚Üí Mint tokens reflecting new value</td></tr>
								<tr><td><strong>Exhibition Income</strong></td><td>Museum loan fees ‚Üí Quarterly distribution to holders</td></tr>
								<tr><td><strong>Piece Sold</strong></td><td>Artwork sold at auction ‚Üí Burn corresponding tokens, distribute proceeds</td></tr>
								<tr><td><strong>Insurance Claim</strong></td><td>Damaged artwork ‚Üí Insurance payout distributed, tokens burned</td></tr>
								</table>

								<div class="notification success">
										<strong>For Issuers:</strong> Token servicing maintains investor trust, ensures compliance, and manages asset lifecycle events professionally.
								</div>

								<div class="notification">
										<strong>For Investors:</strong> Regular servicing provides transparency, protects rights, and ensures you receive all benefits of asset ownership.
								</div>`;
						
						showModal(content);
				}

				// Add form helper updates
				document.addEventListener('DOMContentLoaded', function() {
						// Add event listener for corporate action selection
						const corporateActionSelect = document.getElementById('corporateAction');
						if (corporateActionSelect) {
								corporateActionSelect.addEventListener('change', function() {
										const helpText = document.getElementById('actionHelp');
										const parameter = document.getElementById('actionParameter');
										
										switch (this.value) {
												case 'dividend':
														helpText.textContent = 'Enter total distribution amount (e.g., 50000 for $50,000)';
														parameter.placeholder = 'e.g., 50000 (total rental income to distribute)';
														break;
												case 'mint':
														helpText.textContent = 'Enter number of new tokens to mint based on asset appreciation';
														parameter.placeholder = 'e.g., 500 (new tokens for $500K asset increase)';
														break;
												case 'burn':
														helpText.textContent = 'Enter number of tokens to burn due to asset sale/liquidation';
														parameter.placeholder = 'e.g., 1000 (tokens to burn for partial asset sale)';
														break;
												case 'pause':
														helpText.textContent = 'Enter reason for pause (regulatory review, compliance audit, etc.)';
														parameter.placeholder = 'e.g., "SEC compliance review - estimated 7 days"';
														break;
												case 'force-transfer':
														helpText.textContent = 'Enter destination wallet address for court-ordered transfer';
														parameter.placeholder = 'e.g., 0x742d35Cc6bF8B4C40...';
														break;
												case 'split':
														helpText.textContent = 'Enter split ratio (e.g., 2 for 2:1 split, 3 for 3:1 split)';
														parameter.placeholder = 'e.g., 2 (each token becomes 2 tokens)';
														break;
												default:
														helpText.textContent = 'Select an action above for specific guidance';
														parameter.placeholder = 'Enter amount, address, or description';
										}
								});
						}
				});

				// Additional educational guide functions
				function showRWAPreparationGuide() {
						let content = `<h2>üîç RWA Preparation & Valuation Guide</h2>
								<div class="notification">
										<strong>Purpose:</strong> Transform physical assets into digital, tradeable tokens through professional preparation and valuation.
								</div>

								<table class="data-table">
								<thead><tr><th>Step</th><th>Traditional Investment</th><th>RWA Tokenization</th></tr></thead>
								<tbody>
								<tr><td><strong>Asset Access</strong></td><td>High minimum ($1M+)</td><td>Fractional ownership ($1K+)</td></tr>
								<tr><td><strong>Documentation</strong></td><td>Paper certificates</td><td>Blockchain-based tokens</td></tr>
								<tr><td><strong>Liquidity</strong></td><td>Illiquid, hard to sell</td><td>Secondary market trading</td></tr>
								<tr><td><strong>Transparency</strong></td><td>Limited reporting</td><td>Real-time on-chain data</td></tr>
								<tr><td><strong>Geographic Access</strong></td><td>Local investors only</td><td>Global investor pool</td></tr>
								</tbody></table>

								<div class="notification success">
										<strong>RWA Preparation Process:</strong><br>
										1. Asset identification and due diligence<br>
										2. Professional valuation and appraisal<br>
										3. Legal structuring and compliance setup<br>
										4. Digital twin creation and documentation<br>
										5. Smart contract architecture design
								</div>

								<div class="notification">
										<strong>Examples of Tokenizable Assets:</strong><br>
										‚Ä¢ Real Estate: Commercial properties, residential complexes<br>
										‚Ä¢ Art & Collectibles: Fine art, vintage cars, rare wines<br>
										‚Ä¢ Infrastructure: Renewable energy projects, toll roads<br>
										‚Ä¢ Commodities: Precious metals, agricultural products<br>
										‚Ä¢ Private Equity: Startup investments, growth companies
								</div>`;
						
						showModal(content);
				}

				function showInvestorOnboardingGuide() {
						let content = `<h2>üîç Investor Onboarding & KYC Guide</h2>
								<div class="notification">
										<strong>Purpose:</strong> Ensure only qualified, compliant investors can access tokenized asset investments.
								</div>

								<table class="data-table">
								<thead><tr><th>Aspect</th><th>Traditional Securities</th><th>Tokenized RWAs</th></tr></thead>
								<tbody>
								<tr><td><strong>KYC Process</strong></td><td>Paper-based, slow</td><td>Digital, automated verification</td></tr>
								<tr><td><strong>Accreditation Check</strong></td><td>Manual verification</td><td>Blockchain-based credentials</td></tr>
								<tr><td><strong>Investment Tracking</strong></td><td>Separate systems</td><td>Integrated token platform</td></tr>
								<tr><td><strong>Compliance Monitoring</strong></td><td>Periodic reviews</td><td>Continuous on-chain monitoring</td></tr>
								<tr><td><strong>Rights Management</strong></td><td>Paper voting proxies</td><td>Digital governance tokens</td></tr>
								</tbody></table>

								<div class="notification success">
										<strong>KYC Requirements for RWA Tokens:</strong><br>
										‚Ä¢ Identity verification (government-issued ID)<br>
										‚Ä¢ Address verification (utility bills, bank statements)<br>
										‚Ä¢ Accredited investor status (income/net worth proof)<br>
										‚Ä¢ Anti-money laundering (AML) screening<br>
										‚Ä¢ Sanctions list checking (OFAC compliance)
								</div>

								<div class="notification">
										<strong>Investor Categories:</strong><br>
										‚Ä¢ <strong>Accredited Investors:</strong> $200K+ annual income or $1M+ net worth<br>
										‚Ä¢ <strong>Qualified Institutional Buyers:</strong> $100M+ assets under management<br>
										‚Ä¢ <strong>Family Offices:</strong> Ultra-high-net-worth family investment vehicles<br>
										‚Ä¢ <strong>Pension Funds:</strong> Institutional retirement fund managers<br>
										‚Ä¢ <strong>Sovereign Wealth Funds:</strong> Government investment entities
								</div>

								<div class="notification">
										<strong>Benefits of Tokenized Onboarding:</strong><br>
										‚Ä¢ Faster verification (days vs. weeks)<br>
										‚Ä¢ Global investor reach<br>
										‚Ä¢ Automated compliance monitoring<br>
										‚Ä¢ Reduced operational costs<br>
										‚Ä¢ Enhanced transparency and auditability
								</div>`;
						
						showModal(content);
				}

				function showSecondaryTradingGuide() {
						let content = `<h2>üîç Secondary Trading & Liquidity Guide</h2>
								<div class="notification">
										<strong>Purpose:</strong> Enable compliant trading of tokenized assets while maintaining regulatory compliance and investor protection.
								</div>

								<table class="data-table">
								<thead><tr><th>Feature</th><th>Traditional Securities</th><th>Tokenized RWAs</th></tr></thead>
								<tbody>
								<tr><td><strong>Trading Hours</strong></td><td>Market hours only</td><td>24/7 availability</td></tr>
								<tr><td><strong>Settlement Time</strong></td><td>T+2 (2 days)</td><td>Near-instant settlement</td></tr>
								<tr><td><strong>Minimum Trade Size</strong></td><td>Full shares/units</td><td>Fractional tokens</td></tr>
								<tr><td><strong>Geographic Access</strong></td><td>Local exchanges</td><td>Global market access</td></tr>
								<tr><td><strong>Transparency</strong></td><td>Limited order book</td><td>Full blockchain visibility</td></tr>
								<tr><td><strong>Costs</strong></td><td>High brokerage fees</td><td>Low transaction costs</td></tr>
								</tbody></table>

								<div class="notification success">
										<strong>Compliant Trading Mechanisms:</strong><br>
										‚Ä¢ <strong>Private Exchanges:</strong> Regulated platforms for accredited investors<br>
										‚Ä¢ <strong>OTC Markets:</strong> Direct peer-to-peer trading with compliance checks<br>
										‚Ä¢ <strong>DeFi Protocols:</strong> Decentralized exchanges with KYC gates<br>
										‚Ä¢ <strong>Auction Systems:</strong> Periodic batch trading for price discovery
								</div>

								<div class="notification">
										<strong>ERC3643 Compliance Features:</strong><br>
										‚Ä¢ Identity verification before trading<br>
										‚Ä¢ Transfer restrictions based on jurisdiction<br>
										‚Ä¢ Automatic compliance rule enforcement<br>
										‚Ä¢ Regulatory pause capabilities<br>
										‚Ä¢ Forced transfer for legal requirements
								</div>

								<div class="notification">
										<strong>Liquidity Benefits:</strong><br>
										‚Ä¢ Exit opportunities for long-term assets<br>
										‚Ä¢ Price discovery through market mechanisms<br>
										‚Ä¢ Portfolio rebalancing capabilities<br>
										‚Ä¢ Risk management through diversification<br>
										‚Ä¢ Access to global capital for asset growth
								</div>

								<div class="notification">
										<strong>Trading Examples:</strong><br>
										‚Ä¢ Real Estate: Trade building ownership fractions<br>
										‚Ä¢ Art: Buy/sell pieces from collections<br>
										‚Ä¢ Infrastructure: Exchange renewable energy stakes<br>
										‚Ä¢ Private Equity: Secondary market for startup shares
								</div>`;
						
						showModal(content);
				}
		</script>
</body>
</html>
